# tls_ja3_postex.rules (corrected) 
# Hunting rules for suspicious JA3 values associated with common post-ex/C2 tooling.
# WARNING: JA3 is not unique; treat as hunting signals and pair with context (dst, SNI, JA3S).
# Source: common community listings; customize to your environment.

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"TLS JA3 hunting: known C2 framework client (72a589da586844d7f0818ce684948eea)";flow:established,to_server;ja3.hash; content:"72a589da586844d7f0818ce684948eea";classtype:trojan-activity;metadata:affected_product Any, attack_target Client, deployment Perimeter;sid:2101101; rev:1;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"TLS JA3 hunting: suspicious client (a0e9f5d64349fb13191bc781f81f42e1)";flow:established,to_server;ja3.hash; content:"a0e9f5d64349fb13191bc781f81f42e1";classtype:trojan-activity;metadata:affected_product Any, attack_target Client, deployment Perimeter;sid:2101104; rev:1;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"TLS JA3 hunting: suspicious client (b20b44b18b853ef29ab773e921b03422)";flow:established,to_server;ja3.hash; content:"b20b44b18b853ef29ab773e921b03422";classtype:trojan-activity;metadata:affected_product Any, attack_target Client, deployment Perimeter;sid:2101103; rev:1;)
