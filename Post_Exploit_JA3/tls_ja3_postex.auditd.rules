###############################################################################
# EXECVE: capture process launches by interactive users (gives argv, cwd, exe)
###############################################################################
-a always,exit -F arch=b64 -S execve -F auid>=1000 -F auid!=4294967295 -k user_exec
-a always,exit -F arch=b32 -S execve -F auid>=1000 -F auid!=4294967295 -k user_exec

###############################################################################
# CONNECT: capture successful outbound TCP connect() by interactive users
# NOTE: We cannot filter by JA3 here; this just records who connected to where.
###############################################################################
-a always,exit -F arch=b64 -S connect -F auid>=1000 -F auid!=4294967295 -F success=1 -k user_connect
-a always,exit -F arch=b32 -S connect -F auid>=1000 -F auid!=4294967295 -F success=1 -k user_connect

###############################################################################
# (Optional) SEND SIZE: large sends (volume context that often accompanies C2/exfil)
###############################################################################
-a always,exit -F arch=b64 -S sendto,sendmsg -F auid>=1000 -F auid!=4294967295 -F a2>=1048576 -k large_send_1mb
-a always,exit -F arch=b32 -S sendto,sendmsg -F auid>=1000 -F auid!=4294967295 -F a2>=1048576 -k large_send_1mb
