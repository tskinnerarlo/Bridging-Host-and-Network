# reverse_shell.rules (corrected for Suricata 7.x) 
# Action: alert (IDS)
# Notes: uses http_client_body sticky buffer; change to http.request_body if needed.
# 1) bash reverse shell in HTTP request body
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"POSSIBLE RCE: bash TCP reverse shell command in HTTP request";flow:to_server,established;http.request_body;content:"bash -i"; nocase;content:"/dev/tcp/";nocase; distance:0;content:"0>&1";nocase; distance:0;classtype:attempted-admin;metadata:attack_target Server, created_at 2025_08_18;sid:1002001; rev:2;)

# 2) netcat reverse shell flags in HTTP request body
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"POSSIBLE RCE: netcat reverse shell flags in HTTP request"; flow:to_server,established; http.request_body; content:"nc "; nocase;content:" -e "; nocase; within:10; classtype:attempted-admin; metadata:attack_target Server, created_at 2025_08_18; sid:1002002; rev:2;)

# 3) ncat --exec reverse shell flags in HTTP request body
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"POSSIBLE RCE: ncat exec reverse shell flags in HTTP request"; flow:to_server,established; http.request_body; content:"ncat "; nocase; content:" --exec "; nocase; within:20; classtype:attempted-admin; metadata:attack_target Server, created_at 2025_08_18; sid:1002005; rev:2;)


